/* Lyra Theme - shadcn/ui */

::selection {
    background-color: oklch(0.623 0.214 259.815);
    color: oklch(0.985 0 0);
}

:root {
    /* Lyra light theme - with Cloud Chaser Blonde background */
    --background: oklch(0.958 0.012 85); /* hsl(43, 19%, 93%) - warm cream */
    --foreground: oklch(0.145 0 0);
    --card: oklch(0.958 0.012 85); /* match background */
    --card-foreground: oklch(0.145 0 0);
    --popover: oklch(1 0 0);
    --popover-foreground: oklch(0.145 0 0);
    --primary: oklch(0.205 0 0);
    --primary-foreground: oklch(0.985 0 0);
    --secondary: oklch(0.94 0.015 85); /* warmer cream for code blocks - less grey */
    --secondary-foreground: oklch(0.205 0 0);
    --muted: oklch(0.95 0.003 85);
    --muted-foreground: oklch(0.556 0 0);
    --accent: oklch(0.95 0.003 85);
    --accent-foreground: oklch(0.205 0 0);
    --destructive: oklch(0.58 0.22 27);
    --border: oklch(0.88 0.003 85);
    --input: oklch(0.88 0.003 85);
    --ring: oklch(0.708 0 0);
    --chart-1: oklch(0.809 0.105 251.813);
    --chart-2: oklch(0.623 0.214 259.815);
    --chart-3: oklch(0.546 0.245 262.881);
    --chart-4: oklch(0.488 0.243 264.376);
    --chart-5: oklch(0.424 0.199 265.638);
    --radius: 0.625rem;
    --sidebar: oklch(0.97 0.003 85);
    --sidebar-foreground: oklch(0.145 0 0);
    --sidebar-primary: oklch(0.205 0 0);
    --sidebar-primary-foreground: oklch(0.985 0 0);
    --sidebar-accent: oklch(0.95 0.003 85);
    --sidebar-accent-foreground: oklch(0.205 0 0);
    --sidebar-border: oklch(0.88 0.003 85);
    --sidebar-ring: oklch(0.708 0 0);
    
    /* Syntax highlighting - light mode (warm cream palette, hue 85) */
    --sh-class: oklch(0.45 0.08 85);        /* darker warm brown */
    --sh-identifier: oklch(0.35 0.06 85);   /* dark warm brown */
    --sh-sign: oklch(0.55 0.05 85);        /* medium warm brown */
    --sh-string: oklch(0.50 0.10 85);      /* rich warm brown */
    --sh-keyword: oklch(0.40 0.12 85);     /* deep warm brown */
    --sh-comment: oklch(0.65 0.03 85);     /* light warm gray */
    --sh-jsxliterals: oklch(0.48 0.09 85); /* medium-dark warm brown */
    --sh-property: oklch(0.42 0.11 85);    /* dark warm brown */
    --sh-entity: oklch(0.42 0.11 85);      /* dark warm brown */
}

@media (prefers-color-scheme: dark) {
    :root {
        /* Lyra dark theme */
        --background: oklch(0.145 0 0);
        --foreground: oklch(0.985 0 0);
        --card: oklch(0.205 0 0);
        --card-foreground: oklch(0.985 0 0);
        --popover: oklch(0.205 0 0);
        --popover-foreground: oklch(0.985 0 0);
        --primary: oklch(0.87 0 0);
        --primary-foreground: oklch(0.205 0 0);
        --secondary: oklch(0.205 0 0); /* same as card - matches cookie banner */
        --secondary-foreground: #ebdbb2; /* Gruvbox fg1 */
        --muted: oklch(0.269 0 0);
        --muted-foreground: oklch(0.708 0 0);
        --accent: oklch(0.371 0 0);
        --accent-foreground: oklch(0.985 0 0);
        --destructive: oklch(0.704 0.191 22.216);
        --border: oklch(1 0 0 / 10%);
        --input: oklch(1 0 0 / 15%);
        --ring: oklch(0.556 0 0);
        --chart-1: oklch(0.809 0.105 251.813);
        --chart-2: oklch(0.623 0.214 259.815);
        --chart-3: oklch(0.546 0.245 262.881);
        --chart-4: oklch(0.488 0.243 264.376);
        --chart-5: oklch(0.424 0.199 265.638);
        --sidebar: oklch(0.205 0 0);
        --sidebar-foreground: oklch(0.985 0 0);
        --sidebar-primary: oklch(0.488 0.243 264.376);
        --sidebar-primary-foreground: oklch(0.985 0 0);
        --sidebar-accent: oklch(0.269 0 0);
        --sidebar-accent-foreground: oklch(0.985 0 0);
        --sidebar-border: oklch(1 0 0 / 10%);
        --sidebar-ring: oklch(0.556 0 0);
        
        /* Syntax highlighting - Gruvbox hard contrast dark palette */
        --sh-class: #fabd2f;        /* Gruvbox yellow - classes/types */
        --sh-identifier: #ebdbb2;   /* Gruvbox fg1 - default text */
        --sh-sign: #a89984;         /* Gruvbox gray - operators/punctuation */
        --sh-string: #b8bb26;       /* Gruvbox green - strings */
        --sh-keyword: #fb4934;      /* Gruvbox red - keywords */
        --sh-comment: #928374;      /* Gruvbox gray - comments */
        --sh-jsxliterals: #8ec07c;  /* Gruvbox aqua - JSX literals */
        --sh-property: #83a598;     /* Gruvbox blue - properties */
        --sh-entity: #d3869b;       /* Gruvbox purple - entities */
    }
    html {
        color-scheme: dark;
    }
}

html {
    min-width: 360px;
    background-color: var(--background);
    color: var(--foreground);
}

body {
    background-color: inherit;
    color: inherit;
}

@layer base {
    * {
        border-color: var(--border);
    }
}

.prose .anchor {
    position: absolute;
    visibility: hidden;
    text-decoration: none;
    margin-left: -1em;
    padding-right: 0.5em;
    width: 80%;
    max-width: 700px;
    cursor: pointer;
}

.anchor:hover { visibility: visible; }

.prose a { transition: color .2s ease; text-underline-offset: 0.2em; text-decoration-thickness: 0.1em; }

.prose .anchor:after {
    color: var(--muted-foreground);
    content: "#";
}

.prose *:hover > .anchor { visibility: visible; }

.prose pre {
    background-color: var(--secondary);
    border: 1px solid var(--border);
    border-radius: 0;
    overflow-x: auto;
}

.prose code {
    padding: 0.125rem 0.25rem;
    border-radius: 0;
    font-family: var(--font-geist-mono), "Geist Mono", ui-monospace, SFMono-Regular, "SF Mono", monospace !important;
}

.prose pre code {
    padding: 0;
    border: initial;
    line-height: 1.5;
    font-family: var(--font-geist-mono), "Geist Mono", ui-monospace, SFMono-Regular, "SF Mono", monospace !important;
}

.prose code span {
    font-weight: 500;
}

/* Override sugar-high syntax highlighting with warm cream palette */
.prose code .sh__class,
.prose code [class*="sh__class"] { color: var(--sh-class) !important; }
.prose code .sh__identifier,
.prose code [class*="sh__identifier"] { color: var(--sh-identifier) !important; }
.prose code .sh__sign,
.prose code [class*="sh__sign"] { color: var(--sh-sign) !important; }
.prose code .sh__string,
.prose code [class*="sh__string"] { color: var(--sh-string) !important; }
.prose code .sh__keyword,
.prose code [class*="sh__keyword"] { color: var(--sh-keyword) !important; }
.prose code .sh__comment,
.prose code [class*="sh__comment"] { color: var(--sh-comment) !important; }
.prose code .sh__jsxliterals,
.prose code [class*="sh__jsxliterals"] { color: var(--sh-jsxliterals) !important; }
.prose code .sh__property,
.prose code [class*="sh__property"] { color: var(--sh-property) !important; }
.prose code .sh__entity,
.prose code [class*="sh__entity"] { color: var(--sh-entity) !important; }

.prose img { margin: 0; }

/* Remove Tailwind Typography's default backticks around inline code */
.prose :where(:not(pre) > code):not(:where([class~="not-prose"], [class~="not-prose"] *))::before,
.prose :where(:not(pre) > code):not(:where([class~="not-prose"], [class~="not-prose"] *))::after {
    content: "" !important;
}

.prose h2,
h3,
h4 { font-weight: 500 !important; letter-spacing: -0.05em !important; }

.prose strong {
    font-weight: 500;
}

.prose > :first-child {
    margin-top: 1.25em !important;
    margin-bottom: 1.25em !important;
}

pre::-webkit-scrollbar {
    display: none;
}

pre {
    -ms-overflow-style: none;
    scrollbar-width: none;
}

.scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
}

.scrollbar-hide::-webkit-scrollbar {
    display: none;
}

.bento-scroll {
    -ms-overflow-style: none;
    scrollbar-width: none;
    -webkit-overflow-scrolling: touch;
}

.bento-scroll::-webkit-scrollbar {
    display: none;
    width: 0;
    height: 0;
    background: transparent;
}

.bento-scroll::-webkit-scrollbar-thumb {
    background: transparent;
}

/* Remove Safari input shadow on mobile */
input[type="text"],
input[type="email"] {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
}

/* Cloudflare Turnstile widget styling */
.cf-turnstile {
    flex-shrink: 0;
}

.prose .tweet a {
    text-decoration: inherit;
    font-weight: 500;
}


table {
    display: block;
    max-width: fit-content;
    overflow-x: auto;
    white-space: nowrap;
}

.prose .callout > p {
    margin: 0 !important;
}

.title {
    text-wrap: balance;
}

/* Mermaid diagram styling to fix text cutoff issues */
.mermaid-diagram {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    max-width: 100%;
    margin-left: auto;
    margin-right: auto;
    overflow: visible;
}

.mermaid-diagram svg {
    display: block;
    width: 100% !important;
    height: auto !important;
    overflow: visible !important;
}

/* Fix mermaid node text cutoff */
.mermaid-diagram .node rect,
.mermaid-diagram .node circle,
.mermaid-diagram .node ellipse,
.mermaid-diagram .node polygon,
.mermaid-diagram .node path {
    stroke-width: 2px;
}

/* Ensure labels have proper padding and don't get cut off */
.mermaid-diagram .nodeLabel,
.mermaid-diagram .edgeLabel {
    font-family: var(--font-geist-mono), "Geist Mono", ui-monospace, SFMono-Regular, "SF Mono", monospace !important;
    font-size: 13px !important;
    line-height: 1.4 !important;
    overflow: visible !important;
}

/* Fix all text elements to prevent clipping */
.mermaid-diagram text,
.mermaid-diagram tspan,
.mermaid-diagram foreignObject {
    overflow: visible !important;
    text-overflow: clip !important;
}

/* Remove any clipPath constraints that might cut off text */
.mermaid-diagram clipPath,
.mermaid-diagram defs clipPath {
    display: none !important;
}

/* Add padding to edge labels */
.mermaid-diagram .edgeLabel {
    background-color: transparent !important;
    padding: 0 2px !important;
}

/* Typography for labels only */
.mermaid-diagram .nodeLabel,
.mermaid-diagram .edgeLabel,
.mermaid-diagram .node text,
.mermaid-diagram text {
    font-family: var(--font-geist-mono), "Geist Mono", ui-monospace, SFMono-Regular, "SF Mono", monospace !important;
    font-size: 13px !important;
}

/* Force SVG to not constrain content */
.mermaid-diagram svg[viewBox] {
    overflow: visible !important;
}

/* Ensure text content isn't masked or clipped */
.mermaid-diagram g[clip-path] {
    clip-path: none !important;
}

/* Sandpack - brutalist styling (no rounded corners) */
.sp-wrapper,
.sp-layout,
.sp-stack,
.sp-preview-container,
.sp-code-editor,
.sp-preview {
    --sp-border-radius: 0 !important;
    border-radius: 0 !important;
}

/* Mermaid diagram container - brutalist styling */
.mermaid-diagram {
    border: none;
    padding: 1rem;
}

/* Mermaid chart colors - light mode (warm cream palette) */
.mermaid-diagram .node rect,
.mermaid-diagram .node circle,
.mermaid-diagram .node ellipse,
.mermaid-diagram .node polygon {
    fill: oklch(0.94 0.015 85) !important;
    stroke: oklch(0.75 0.05 85) !important;
}

.mermaid-diagram .edgePath .path {
    stroke: oklch(0.65 0.04 85) !important;
}

.mermaid-diagram .edgeLabel {
    background-color: oklch(0.96 0.012 85) !important;
}

.mermaid-diagram .cluster rect {
    fill: oklch(0.93 0.014 85) !important;
    stroke: oklch(0.70 0.05 85) !important;
}

.mermaid-diagram .label {
    color: oklch(0.25 0.06 85) !important;
}

/* Mermaid chart colors - dark mode */
@media (prefers-color-scheme: dark) {
    .mermaid-diagram .node rect,
    .mermaid-diagram .node circle,
    .mermaid-diagram .node ellipse,
    .mermaid-diagram .node polygon {
        fill: oklch(0.269 0 0) !important;
        stroke: oklch(0.4 0 0) !important;
    }

    .mermaid-diagram .edgePath .path {
        stroke: oklch(0.5 0 0) !important;
    }

    .mermaid-diagram .edgeLabel {
        background-color: oklch(0.205 0 0) !important;
    }

    .mermaid-diagram .cluster rect {
        fill: oklch(0.22 0 0) !important;
        stroke: oklch(0.35 0 0) !important;
    }

    .mermaid-diagram .label {
        color: oklch(0.9 0 0) !important;
    }

    /* Subtle halo for edge labels in dark mode */
    .mermaid-diagram .edgeLabel text,
    .mermaid-diagram .edgeLabel tspan {
        paint-order: stroke;
        stroke: rgba(17, 16, 16, 0.85);
        stroke-width: 2px;
        stroke-linejoin: round;
    }
}
